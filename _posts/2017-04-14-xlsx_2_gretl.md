---
layout: post
title: Импорт экселевского файла в gretl
---

Есть [gretl](http://gretl.sourceforge.net) — чудесный бесплатный открытый пакет для эконометрики! Уже два человека меня спрашивали, как импортировать панельные данные в gretl из экселя :)

Шаг 1. Убираем всякий мусор с экселевского листа. Никаких графиков, никаких выделений шрифтом/цветом. Только данные.

Шаг 2. Размещаем названия переменных в первой строке. Каждую переменную называем по английски без пробелов. Пробел можно изобразить с помощью нижнего подчеркивания. Например `real_wage`.

Шаг 3. Добавляем в начале переменную `id` и присваеваем ей значения 1, 2, 3, 4, ... Если название `id` уже занято, то `id_` или как-нибудь ещё :)

Шаг 4. Сохраняем полученную табличку в формате `.csv`.

Шаг 5. Заходим в gretl. Выбираем `File` - `Open data` - `User file`. Далее внизу справа выбираем тип файлов `.csv`. Находим нужный файл.

Шаг 6. Далее `gretl` спросит: "Do you want to give the data time-series or panel interpretation?" Отвечаем "Yes".

Шаг 7. Выбираем Structure of dataset `Panel`. Далее `Panel data organization` - `Use index variable`.

Шаг 8. Указываем переменные объекта и времени.

Шаг 9. Ура! Осталось только кликнуть `Model` - `Panel` - `Fixed or random effect` и оценить первую модель :)

Зачем нужны шаги?

Шаг 4 нужен для того, чтобы gretl автоматом конвертировал текстовые названия в числовые коды. Например, если объектами являются страны, то при импорте из `.csv` автоматом будет присвоен числовой код каждой стране.

Шаг 3 нужен для того, чтобы gretl не умничал и не пытался красивое название первой переменной (типа `year`) превращать в индекс.
